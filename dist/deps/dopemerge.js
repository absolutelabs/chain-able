var isPureObj = require('./is/pureObj')
var isArray = require('./is/array')
var toS = require('./is/toS')
var ObjectKeys = require('./util/keys')
var ObjectAssign = require('./util/assign')
var isUndefined = require('./is/undefined')

// const isRegExp = require('./is/regexp')
// const isDate = require('./is/date')

var ezType = function (x) { return (isArray(x) ? 'array' : typeof x); }

// @TODO convert forEach for faster loops
function isMergeableObj(val) {
  return (
    // not null object
    isPureObj(val) &&
    // object toString is not a date or regex
    !['[object RegExp]', '[object Date]'].includes(toS(val))
  )
}

function emptyTarget(val) {
  return isArray(val) ? [] : {}
}
function cloneIfNeeded(value, optsArg) {
  return optsArg.clone === true && isMergeableObj(value)
    ? deepmerge(emptyTarget(value), value, optsArg)
    : value
}

function defaultArrayMerge(target, source, optsArg) {
  var destination = target.slice()

  for (var i = 0; i < source.length; i++) {
    var v = source[i]
    if (isUndefined(destination[i])) {
      destination[i] = cloneIfNeeded(v, optsArg)
    }
    else if (isMergeableObj(v)) {
      destination[i] = deepmerge(target[i], v, optsArg)
    }
    else if (target.indexOf(v) === -1) {
      destination.push(cloneIfNeeded(v, optsArg))
    }
  }
  return destination
}

function mergeObj(target, source, optsArg) {
  var destination = {}
  if (isMergeableObj(target)) {
    var targetKeys = ObjectKeys(target)
    for (var k = 0; k < targetKeys.length; k++) {
      destination[targetKeys[k]] = cloneIfNeeded(target[targetKeys[k]], optsArg)
    }
  }
  var sourceKeys = ObjectKeys(source)
  for (var s = 0; s < sourceKeys.length; s++) {
    var key = sourceKeys[s]
    if (!isMergeableObj(source[key]) || !target[key]) {
      destination[key] = cloneIfNeeded(source[key], optsArg)
    }
    else {
      destination[key] = deepmerge(target[key], source[key], optsArg)
    }
  }

  return destination
}

function deepmerge(target, source, optsArg) {
  if (isArray(source)) {
    var arrayMerge = optsArg.arrayMerge;
    return isArray(target)
      ? arrayMerge(target, source, optsArg)
      : cloneIfNeeded(source, optsArg)
  }

  // else
  return mergeObj(target, source, optsArg)
}

// unused
// @TODO options for merging arr, and on any type combo
// const todoOpts = {
//   // when: { left(cb), right(cb) }
//   // whenLeft(cb): {}
//   objToArr: false, // not implemented
//   stringConcat: false, // not implemented
//   numberOperation: "+ * ^ toarr cb",
//   promises... wait until finished then call merge???
//   boolPrefer: 0, 1, true, false
// boolAsRight: true,
//
// }

function eqq(arr1, arr2) {
  return arr1[0] === arr2[0] && arr1[1] === arr2[1]
}

function eqCurry(types) {
  return eqq.bind(null, types)
}

function getDefaults() {
  return {
    arrayMerge: defaultArrayMerge,
    stringToArray: true,
    boolToArray: false,
    ignoreTypes: ['null', 'undefined'],
    // debug: true,
  }
}

// eslint-disable-next-line complexity
function dopemerge(obj1, obj2, opts) {
  // if they are identical, fastest === check
  if (obj1 === obj2) { return obj1 }

  // setup options
  var options = ObjectAssign(getDefaults(), opts || {})
  var ignoreTypes = options.ignoreTypes;
  var stringToArray = options.stringToArray;
  var boolToArray = options.boolToArray;
  var clone = options.clone;

  var types = [ezType(obj1), ezType(obj2)]

  // check one then check the other
  // @TODO might want to push undefined null nan into array but...
  if (ignoreTypes.includes(types[0]) === true) { return obj2 }
  if (ignoreTypes.includes(types[1]) === true) { return obj1 }

  var eq = eqCurry(types)

  // uglifier optimizes into a wicked ternary
  if (eq(['boolean', 'boolean'])) {
    return boolToArray ? [obj1, obj2] : obj2
  }
  else if (eq(['string', 'string'])) {
    return stringToArray ? [obj1, obj2] : obj1 + obj2
  }
  else if (eq(['array', 'string'])) {
    return (clone ? obj1.slice(0) : obj1).concat([obj2])
  }
  else if (eq(['string', 'array'])) {
    return (clone ? obj2.slice(0) : obj2).concat([obj1])
  }
  else {
    return deepmerge(obj1, obj2, options)
  }
}

module.exports = dopemerge

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZG9wZW1lcmdlLmpzIiwic291cmNlcyI6WyJkb3BlbWVyZ2UuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgaXNQdXJlT2JqID0gcmVxdWlyZSgnLi9pcy9wdXJlT2JqJylcbmNvbnN0IGlzQXJyYXkgPSByZXF1aXJlKCcuL2lzL2FycmF5JylcbmNvbnN0IHRvUyA9IHJlcXVpcmUoJy4vaXMvdG9TJylcbmNvbnN0IE9iamVjdEtleXMgPSByZXF1aXJlKCcuL3V0aWwva2V5cycpXG5jb25zdCBPYmplY3RBc3NpZ24gPSByZXF1aXJlKCcuL3V0aWwvYXNzaWduJylcbmNvbnN0IGlzVW5kZWZpbmVkID0gcmVxdWlyZSgnLi9pcy91bmRlZmluZWQnKVxuXG4vLyBjb25zdCBpc1JlZ0V4cCA9IHJlcXVpcmUoJy4vaXMvcmVnZXhwJylcbi8vIGNvbnN0IGlzRGF0ZSA9IHJlcXVpcmUoJy4vaXMvZGF0ZScpXG5cbmNvbnN0IGV6VHlwZSA9IHggPT4gKGlzQXJyYXkoeCkgPyAnYXJyYXknIDogdHlwZW9mIHgpXG5cbi8vIEBUT0RPIGNvbnZlcnQgZm9yRWFjaCBmb3IgZmFzdGVyIGxvb3BzXG5mdW5jdGlvbiBpc01lcmdlYWJsZU9iaih2YWwpIHtcbiAgcmV0dXJuIChcbiAgICAvLyBub3QgbnVsbCBvYmplY3RcbiAgICBpc1B1cmVPYmoodmFsKSAmJlxuICAgIC8vIG9iamVjdCB0b1N0cmluZyBpcyBub3QgYSBkYXRlIG9yIHJlZ2V4XG4gICAgIVsnW29iamVjdCBSZWdFeHBdJywgJ1tvYmplY3QgRGF0ZV0nXS5pbmNsdWRlcyh0b1ModmFsKSlcbiAgKVxufVxuXG5mdW5jdGlvbiBlbXB0eVRhcmdldCh2YWwpIHtcbiAgcmV0dXJuIGlzQXJyYXkodmFsKSA/IFtdIDoge31cbn1cbmZ1bmN0aW9uIGNsb25lSWZOZWVkZWQodmFsdWUsIG9wdHNBcmcpIHtcbiAgcmV0dXJuIG9wdHNBcmcuY2xvbmUgPT09IHRydWUgJiYgaXNNZXJnZWFibGVPYmoodmFsdWUpXG4gICAgPyBkZWVwbWVyZ2UoZW1wdHlUYXJnZXQodmFsdWUpLCB2YWx1ZSwgb3B0c0FyZylcbiAgICA6IHZhbHVlXG59XG5cbmZ1bmN0aW9uIGRlZmF1bHRBcnJheU1lcmdlKHRhcmdldCwgc291cmNlLCBvcHRzQXJnKSB7XG4gIHZhciBkZXN0aW5hdGlvbiA9IHRhcmdldC5zbGljZSgpXG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBzb3VyY2UubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgdiA9IHNvdXJjZVtpXVxuICAgIGlmIChpc1VuZGVmaW5lZChkZXN0aW5hdGlvbltpXSkpIHtcbiAgICAgIGRlc3RpbmF0aW9uW2ldID0gY2xvbmVJZk5lZWRlZCh2LCBvcHRzQXJnKVxuICAgIH1cbiAgICBlbHNlIGlmIChpc01lcmdlYWJsZU9iaih2KSkge1xuICAgICAgZGVzdGluYXRpb25baV0gPSBkZWVwbWVyZ2UodGFyZ2V0W2ldLCB2LCBvcHRzQXJnKVxuICAgIH1cbiAgICBlbHNlIGlmICh0YXJnZXQuaW5kZXhPZih2KSA9PT0gLTEpIHtcbiAgICAgIGRlc3RpbmF0aW9uLnB1c2goY2xvbmVJZk5lZWRlZCh2LCBvcHRzQXJnKSlcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGRlc3RpbmF0aW9uXG59XG5cbmZ1bmN0aW9uIG1lcmdlT2JqKHRhcmdldCwgc291cmNlLCBvcHRzQXJnKSB7XG4gIHZhciBkZXN0aW5hdGlvbiA9IHt9XG4gIGlmIChpc01lcmdlYWJsZU9iaih0YXJnZXQpKSB7XG4gICAgdmFyIHRhcmdldEtleXMgPSBPYmplY3RLZXlzKHRhcmdldClcbiAgICBmb3IgKHZhciBrID0gMDsgayA8IHRhcmdldEtleXMubGVuZ3RoOyBrKyspIHtcbiAgICAgIGRlc3RpbmF0aW9uW3RhcmdldEtleXNba11dID0gY2xvbmVJZk5lZWRlZCh0YXJnZXRbdGFyZ2V0S2V5c1trXV0sIG9wdHNBcmcpXG4gICAgfVxuICB9XG4gIHZhciBzb3VyY2VLZXlzID0gT2JqZWN0S2V5cyhzb3VyY2UpXG4gIGZvciAodmFyIHMgPSAwOyBzIDwgc291cmNlS2V5cy5sZW5ndGg7IHMrKykge1xuICAgIHZhciBrZXkgPSBzb3VyY2VLZXlzW3NdXG4gICAgaWYgKCFpc01lcmdlYWJsZU9iaihzb3VyY2Vba2V5XSkgfHwgIXRhcmdldFtrZXldKSB7XG4gICAgICBkZXN0aW5hdGlvbltrZXldID0gY2xvbmVJZk5lZWRlZChzb3VyY2Vba2V5XSwgb3B0c0FyZylcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICBkZXN0aW5hdGlvbltrZXldID0gZGVlcG1lcmdlKHRhcmdldFtrZXldLCBzb3VyY2Vba2V5XSwgb3B0c0FyZylcbiAgICB9XG4gIH1cblxuICByZXR1cm4gZGVzdGluYXRpb25cbn1cblxuZnVuY3Rpb24gZGVlcG1lcmdlKHRhcmdldCwgc291cmNlLCBvcHRzQXJnKSB7XG4gIGlmIChpc0FycmF5KHNvdXJjZSkpIHtcbiAgICBjb25zdCB7YXJyYXlNZXJnZX0gPSBvcHRzQXJnXG4gICAgcmV0dXJuIGlzQXJyYXkodGFyZ2V0KVxuICAgICAgPyBhcnJheU1lcmdlKHRhcmdldCwgc291cmNlLCBvcHRzQXJnKVxuICAgICAgOiBjbG9uZUlmTmVlZGVkKHNvdXJjZSwgb3B0c0FyZylcbiAgfVxuXG4gIC8vIGVsc2VcbiAgcmV0dXJuIG1lcmdlT2JqKHRhcmdldCwgc291cmNlLCBvcHRzQXJnKVxufVxuXG4vLyB1bnVzZWRcbi8vIEBUT0RPIG9wdGlvbnMgZm9yIG1lcmdpbmcgYXJyLCBhbmQgb24gYW55IHR5cGUgY29tYm9cbi8vIGNvbnN0IHRvZG9PcHRzID0ge1xuLy8gICAvLyB3aGVuOiB7IGxlZnQoY2IpLCByaWdodChjYikgfVxuLy8gICAvLyB3aGVuTGVmdChjYik6IHt9XG4vLyAgIG9ialRvQXJyOiBmYWxzZSwgLy8gbm90IGltcGxlbWVudGVkXG4vLyAgIHN0cmluZ0NvbmNhdDogZmFsc2UsIC8vIG5vdCBpbXBsZW1lbnRlZFxuLy8gICBudW1iZXJPcGVyYXRpb246IFwiKyAqIF4gdG9hcnIgY2JcIixcbi8vICAgcHJvbWlzZXMuLi4gd2FpdCB1bnRpbCBmaW5pc2hlZCB0aGVuIGNhbGwgbWVyZ2U/Pz9cbi8vICAgYm9vbFByZWZlcjogMCwgMSwgdHJ1ZSwgZmFsc2Vcbi8vIGJvb2xBc1JpZ2h0OiB0cnVlLFxuLy9cbi8vIH1cblxuZnVuY3Rpb24gZXFxKGFycjEsIGFycjIpIHtcbiAgcmV0dXJuIGFycjFbMF0gPT09IGFycjJbMF0gJiYgYXJyMVsxXSA9PT0gYXJyMlsxXVxufVxuXG5mdW5jdGlvbiBlcUN1cnJ5KHR5cGVzKSB7XG4gIHJldHVybiBlcXEuYmluZChudWxsLCB0eXBlcylcbn1cblxuZnVuY3Rpb24gZ2V0RGVmYXVsdHMoKSB7XG4gIHJldHVybiB7XG4gICAgYXJyYXlNZXJnZTogZGVmYXVsdEFycmF5TWVyZ2UsXG4gICAgc3RyaW5nVG9BcnJheTogdHJ1ZSxcbiAgICBib29sVG9BcnJheTogZmFsc2UsXG4gICAgaWdub3JlVHlwZXM6IFsnbnVsbCcsICd1bmRlZmluZWQnXSxcbiAgICAvLyBkZWJ1ZzogdHJ1ZSxcbiAgfVxufVxuXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgY29tcGxleGl0eVxuZnVuY3Rpb24gZG9wZW1lcmdlKG9iajEsIG9iajIsIG9wdHMpIHtcbiAgLy8gaWYgdGhleSBhcmUgaWRlbnRpY2FsLCBmYXN0ZXN0ID09PSBjaGVja1xuICBpZiAob2JqMSA9PT0gb2JqMikgcmV0dXJuIG9iajFcblxuICAvLyBzZXR1cCBvcHRpb25zXG4gIGNvbnN0IG9wdGlvbnMgPSBPYmplY3RBc3NpZ24oZ2V0RGVmYXVsdHMoKSwgb3B0cyB8fCB7fSlcbiAgY29uc3Qge2lnbm9yZVR5cGVzLCBzdHJpbmdUb0FycmF5LCBib29sVG9BcnJheSwgY2xvbmV9ID0gb3B0aW9uc1xuXG4gIGNvbnN0IHR5cGVzID0gW2V6VHlwZShvYmoxKSwgZXpUeXBlKG9iajIpXVxuXG4gIC8vIGNoZWNrIG9uZSB0aGVuIGNoZWNrIHRoZSBvdGhlclxuICAvLyBAVE9ETyBtaWdodCB3YW50IHRvIHB1c2ggdW5kZWZpbmVkIG51bGwgbmFuIGludG8gYXJyYXkgYnV0Li4uXG4gIGlmIChpZ25vcmVUeXBlcy5pbmNsdWRlcyh0eXBlc1swXSkgPT09IHRydWUpIHJldHVybiBvYmoyXG4gIGlmIChpZ25vcmVUeXBlcy5pbmNsdWRlcyh0eXBlc1sxXSkgPT09IHRydWUpIHJldHVybiBvYmoxXG5cbiAgY29uc3QgZXEgPSBlcUN1cnJ5KHR5cGVzKVxuXG4gIC8vIHVnbGlmaWVyIG9wdGltaXplcyBpbnRvIGEgd2lja2VkIHRlcm5hcnlcbiAgaWYgKGVxKFsnYm9vbGVhbicsICdib29sZWFuJ10pKSB7XG4gICAgcmV0dXJuIGJvb2xUb0FycmF5ID8gW29iajEsIG9iajJdIDogb2JqMlxuICB9XG4gIGVsc2UgaWYgKGVxKFsnc3RyaW5nJywgJ3N0cmluZyddKSkge1xuICAgIHJldHVybiBzdHJpbmdUb0FycmF5ID8gW29iajEsIG9iajJdIDogb2JqMSArIG9iajJcbiAgfVxuICBlbHNlIGlmIChlcShbJ2FycmF5JywgJ3N0cmluZyddKSkge1xuICAgIHJldHVybiAoY2xvbmUgPyBvYmoxLnNsaWNlKDApIDogb2JqMSkuY29uY2F0KFtvYmoyXSlcbiAgfVxuICBlbHNlIGlmIChlcShbJ3N0cmluZycsICdhcnJheSddKSkge1xuICAgIHJldHVybiAoY2xvbmUgPyBvYmoyLnNsaWNlKDApIDogb2JqMikuY29uY2F0KFtvYmoxXSlcbiAgfVxuICBlbHNlIHtcbiAgICByZXR1cm4gZGVlcG1lcmdlKG9iajEsIG9iajIsIG9wdGlvbnMpXG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBkb3BlbWVyZ2VcbiJdLCJuYW1lcyI6WyJjb25zdCJdLCJtYXBwaW5ncyI6IkFBQUFBLEdBQUssQ0FBQyxTQUFTLEdBQUcsT0FBTyxDQUFDLGNBQWMsQ0FBQztBQUN6Q0EsR0FBSyxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUMsWUFBWSxDQUFDO0FBQ3JDQSxHQUFLLENBQUMsR0FBRyxHQUFHLE9BQU8sQ0FBQyxVQUFVLENBQUM7QUFDL0JBLEdBQUssQ0FBQyxV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QUNqQyxPQUFPLGFBQWEsR0FBRyxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsR0FBRyxJQUFJLEdBQUcsSUFBSTtHQUNsRDtPQUNJLElBQUksRUFBRSxDQUFDLENBQUMsT0FBTyxFQUFFLFFBQVEsQ0FBQyxDQUFDLEVBQUU7SUFDaEMsT0FBTyxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDO0dBQ3JEO09BQ0ksSUFBSSxFQUFFLENBQUMsQ0FBQyxRQUFRLEVBQUUsT0FBTyxDQUFDLENBQUMsRUFBRTtJQUNoQyxPQUFPLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUM7R0FDckQ7T0FDSTtJQUNILE9BQU8sU0FBUyxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsT0FBTyxDQUFDO0dBQ3RDO0NBQ0Y7O0FBRUQsTUFBTSxDQUFDLE9BQU8sR0FBRyxTQUFTOyJ9